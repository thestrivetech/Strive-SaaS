import { prisma } from '@/lib/database/prisma';
import { setTenantContext } from '@/lib/database/prisma-middleware';

/**
 * Neighborhood Insights Seed Data
 *
 * Creates 25 realistic neighborhood insight records with comprehensive school ratings
 *
 * IMPORTANT: This table must exist in your database before running this seed script.
 * If you get "table does not exist" error, the neighborhood_insights table needs to be
 * created via a migration first.
 *
 * Usage:
 * ```bash
 * cd (platform)
 * npx tsx prisma/seeds/neighborhood-insights-seed.ts
 * ```
 */

async function seedNeighborhoodInsights() {
  console.log('🌱 Starting neighborhood_insights seeding...');
  console.log('');

  // Test organization and user IDs (replace with actual IDs from your database)
  const TEST_ORG_ID = 'system-default'; // From existing seed.ts
  const TEST_USER_ID = 'test-user-id'; // Replace with actual user ID

  const insights = [
    // AUSTIN, TX - Excellent Schools (8.0+)
    {
      organization_id: TEST_ORG_ID,
      area_name: 'Downtown Austin - Zilker',
      area_code: 'ATX-ZLK-001',
      area_type: 'NEIGHBORHOOD',
      zip_code: '78704',
      city: 'Austin',
      state: 'TX',
      county: 'Travis',
      median_price: 650000,
      avg_price: 725000,
      price_per_sqft: 425,
      price_change: 6.2,
      days_on_market: 28,
      inventory: 45,
      median_age: 34.5,
      median_income: 89500,
      households: 8500,
      school_rating: 9.2,
      walk_score: 87,
      bike_score: 78,
      crime_index: 'LOW',
      park_proximity: 0.5,
      commute_time: 18,
      rent_yield: 4.8,
      appreciation_rate: 5.5,
      investment_grade: 'A',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-01'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'West Austin - Tarrytown',
      area_code: 'ATX-TRY-002',
      area_type: 'NEIGHBORHOOD',
      zip_code: '78703',
      city: 'Austin',
      state: 'TX',
      county: 'Travis',
      median_price: 1250000,
      avg_price: 1450000,
      price_per_sqft: 585,
      price_change: 4.8,
      days_on_market: 42,
      inventory: 28,
      median_age: 42.5,
      median_income: 145000,
      households: 5200,
      school_rating: 9.8,
      walk_score: 62,
      bike_score: 58,
      crime_index: 'VERY_LOW',
      park_proximity: 0.8,
      commute_time: 22,
      rent_yield: 3.2,
      appreciation_rate: 4.2,
      investment_grade: 'A',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-02'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'North Austin - Domain Area',
      area_code: 'ATX-DMN-003',
      area_type: 'NEIGHBORHOOD',
      zip_code: '78758',
      city: 'Austin',
      state: 'TX',
      county: 'Travis',
      median_price: 485000,
      avg_price: 525000,
      price_per_sqft: 365,
      price_change: 8.5,
      days_on_market: 25,
      inventory: 68,
      median_age: 32.8,
      median_income: 78000,
      households: 12500,
      school_rating: 8.5,
      walk_score: 72,
      bike_score: 65,
      crime_index: 'LOW',
      park_proximity: 1.2,
      commute_time: 24,
      rent_yield: 5.2,
      appreciation_rate: 6.8,
      investment_grade: 'A',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-03'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'Cedar Park',
      area_code: 'CPK-001',
      area_type: 'ZIP',
      zip_code: '78613',
      city: 'Cedar Park',
      state: 'TX',
      county: 'Williamson',
      median_price: 425000,
      avg_price: 465000,
      price_per_sqft: 245,
      price_change: 9.2,
      days_on_market: 32,
      inventory: 125,
      median_age: 36.5,
      median_income: 92000,
      households: 18500,
      school_rating: 9.0,
      walk_score: 45,
      bike_score: 42,
      crime_index: 'LOW',
      park_proximity: 0.9,
      commute_time: 35,
      rent_yield: 5.8,
      appreciation_rate: 7.5,
      investment_grade: 'A',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-04'),
    },

    // DENVER, CO - Excellent Schools (8.0+)
    {
      organization_id: TEST_ORG_ID,
      area_name: 'Cherry Creek',
      area_code: 'DEN-CHC-001',
      area_type: 'NEIGHBORHOOD',
      zip_code: '80209',
      city: 'Denver',
      state: 'CO',
      county: 'Denver',
      median_price: 875000,
      avg_price: 985000,
      price_per_sqft: 465,
      price_change: 5.5,
      days_on_market: 35,
      inventory: 42,
      median_age: 41.2,
      median_income: 125000,
      households: 6800,
      school_rating: 9.5,
      walk_score: 68,
      bike_score: 72,
      crime_index: 'LOW',
      park_proximity: 0.4,
      commute_time: 20,
      rent_yield: 3.8,
      appreciation_rate: 4.8,
      investment_grade: 'A',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-05'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'Highlands Ranch',
      area_code: 'HRN-001',
      area_type: 'ZIP',
      zip_code: '80126',
      city: 'Highlands Ranch',
      state: 'CO',
      county: 'Douglas',
      median_price: 625000,
      avg_price: 685000,
      price_per_sqft: 285,
      price_change: 7.2,
      days_on_market: 28,
      inventory: 95,
      median_age: 38.5,
      median_income: 105000,
      households: 25000,
      school_rating: 8.8,
      walk_score: 38,
      bike_score: 45,
      crime_index: 'VERY_LOW',
      park_proximity: 0.6,
      commute_time: 32,
      rent_yield: 4.5,
      appreciation_rate: 6.2,
      investment_grade: 'A',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-06'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'Littleton - Ken Caryl',
      area_code: 'LIT-KCY-001',
      area_type: 'NEIGHBORHOOD',
      zip_code: '80127',
      city: 'Littleton',
      state: 'CO',
      county: 'Jefferson',
      median_price: 585000,
      avg_price: 625000,
      price_per_sqft: 265,
      price_change: 6.8,
      days_on_market: 30,
      inventory: 58,
      median_age: 40.5,
      median_income: 98000,
      households: 12500,
      school_rating: 8.7,
      walk_score: 42,
      bike_score: 48,
      crime_index: 'LOW',
      park_proximity: 0.3,
      commute_time: 28,
      rent_yield: 4.2,
      appreciation_rate: 5.8,
      investment_grade: 'A',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-07'),
    },

    // PORTLAND, OR - Excellent Schools (8.0+)
    {
      organization_id: TEST_ORG_ID,
      area_name: 'Lake Oswego',
      area_code: 'LO-001',
      area_type: 'ZIP',
      zip_code: '97034',
      city: 'Lake Oswego',
      state: 'OR',
      county: 'Clackamas',
      median_price: 825000,
      avg_price: 965000,
      price_per_sqft: 425,
      price_change: 3.5,
      days_on_market: 45,
      inventory: 72,
      median_age: 44.5,
      median_income: 125000,
      households: 15500,
      school_rating: 9.6,
      walk_score: 48,
      bike_score: 55,
      crime_index: 'VERY_LOW',
      park_proximity: 0.5,
      commute_time: 25,
      rent_yield: 3.5,
      appreciation_rate: 3.8,
      investment_grade: 'B',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-08'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'West Linn',
      area_code: 'WL-001',
      area_type: 'ZIP',
      zip_code: '97068',
      city: 'West Linn',
      state: 'OR',
      county: 'Clackamas',
      median_price: 685000,
      avg_price: 745000,
      price_per_sqft: 365,
      price_change: 4.2,
      days_on_market: 38,
      inventory: 65,
      median_age: 42.8,
      median_income: 115000,
      households: 10500,
      school_rating: 9.2,
      walk_score: 35,
      bike_score: 42,
      crime_index: 'LOW',
      park_proximity: 0.7,
      commute_time: 28,
      rent_yield: 3.8,
      appreciation_rate: 4.5,
      investment_grade: 'B',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-09'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'Beaverton - Cedar Hills',
      area_code: 'BEV-CH-001',
      area_type: 'NEIGHBORHOOD',
      zip_code: '97005',
      city: 'Beaverton',
      state: 'OR',
      county: 'Washington',
      median_price: 565000,
      avg_price: 615000,
      price_per_sqft: 325,
      price_change: 5.2,
      days_on_market: 35,
      inventory: 85,
      median_age: 38.5,
      median_income: 88000,
      households: 18500,
      school_rating: 8.5,
      walk_score: 58,
      bike_score: 62,
      crime_index: 'LOW',
      park_proximity: 0.8,
      commute_time: 22,
      rent_yield: 4.5,
      appreciation_rate: 5.5,
      investment_grade: 'A',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-10'),
    },

    // PHOENIX, AZ - Good Schools (6.0-7.9)
    {
      organization_id: TEST_ORG_ID,
      area_name: 'Scottsdale - Paradise Valley',
      area_code: 'SCO-PV-001',
      area_type: 'NEIGHBORHOOD',
      zip_code: '85253',
      city: 'Scottsdale',
      state: 'AZ',
      county: 'Maricopa',
      median_price: 925000,
      avg_price: 1150000,
      price_per_sqft: 465,
      price_change: 6.5,
      days_on_market: 38,
      inventory: 125,
      median_age: 48.5,
      median_income: 145000,
      households: 8500,
      school_rating: 7.8,
      walk_score: 35,
      bike_score: 48,
      crime_index: 'VERY_LOW',
      park_proximity: 1.2,
      commute_time: 28,
      rent_yield: 3.2,
      appreciation_rate: 5.2,
      investment_grade: 'B',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-11'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'Chandler - Ocotillo',
      area_code: 'CHN-OCO-001',
      area_type: 'NEIGHBORHOOD',
      zip_code: '85248',
      city: 'Chandler',
      state: 'AZ',
      county: 'Maricopa',
      median_price: 565000,
      avg_price: 615000,
      price_per_sqft: 285,
      price_change: 7.2,
      days_on_market: 28,
      inventory: 95,
      median_age: 36.5,
      median_income: 98000,
      households: 15500,
      school_rating: 7.5,
      walk_score: 42,
      bike_score: 48,
      crime_index: 'LOW',
      park_proximity: 0.9,
      commute_time: 32,
      rent_yield: 4.8,
      appreciation_rate: 6.5,
      investment_grade: 'A',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-12'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'Gilbert - Power Ranch',
      area_code: 'GIL-PR-001',
      area_type: 'NEIGHBORHOOD',
      zip_code: '85297',
      city: 'Gilbert',
      state: 'AZ',
      county: 'Maricopa',
      median_price: 525000,
      avg_price: 575000,
      price_per_sqft: 265,
      price_change: 8.5,
      days_on_market: 25,
      inventory: 105,
      median_age: 34.5,
      median_income: 95000,
      households: 18500,
      school_rating: 7.2,
      walk_score: 38,
      bike_score: 42,
      crime_index: 'LOW',
      park_proximity: 0.7,
      commute_time: 35,
      rent_yield: 5.2,
      appreciation_rate: 7.2,
      investment_grade: 'A',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-13'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'Tempe - Downtown',
      area_code: 'TEM-DT-001',
      area_type: 'NEIGHBORHOOD',
      zip_code: '85281',
      city: 'Tempe',
      state: 'AZ',
      county: 'Maricopa',
      median_price: 385000,
      avg_price: 425000,
      price_per_sqft: 285,
      price_change: 5.8,
      days_on_market: 32,
      inventory: 125,
      median_age: 28.5,
      median_income: 62000,
      households: 22500,
      school_rating: 6.8,
      walk_score: 82,
      bike_score: 78,
      crime_index: 'MEDIUM',
      park_proximity: 0.5,
      commute_time: 18,
      rent_yield: 6.2,
      appreciation_rate: 4.8,
      investment_grade: 'B',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-14'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'Mesa - Red Mountain',
      area_code: 'MES-RM-001',
      area_type: 'NEIGHBORHOOD',
      zip_code: '85207',
      city: 'Mesa',
      state: 'AZ',
      county: 'Maricopa',
      median_price: 425000,
      avg_price: 465000,
      price_per_sqft: 245,
      price_change: 6.5,
      days_on_market: 28,
      inventory: 145,
      median_age: 38.5,
      median_income: 78000,
      households: 28500,
      school_rating: 6.5,
      walk_score: 45,
      bike_score: 48,
      crime_index: 'MEDIUM',
      park_proximity: 1.0,
      commute_time: 30,
      rent_yield: 5.5,
      appreciation_rate: 5.8,
      investment_grade: 'B',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-15'),
    },

    // MIAMI, FL - Good Schools (6.0-7.9)
    {
      organization_id: TEST_ORG_ID,
      area_name: 'Coral Gables',
      area_code: 'CG-001',
      area_type: 'ZIP',
      zip_code: '33134',
      city: 'Coral Gables',
      state: 'FL',
      county: 'Miami-Dade',
      median_price: 825000,
      avg_price: 985000,
      price_per_sqft: 485,
      price_change: 7.8,
      days_on_market: 45,
      inventory: 95,
      median_age: 42.5,
      median_income: 118000,
      households: 18500,
      school_rating: 7.5,
      walk_score: 68,
      bike_score: 62,
      crime_index: 'LOW',
      park_proximity: 0.6,
      commute_time: 25,
      rent_yield: 3.8,
      appreciation_rate: 6.2,
      investment_grade: 'B',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-16'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'Brickell',
      area_code: 'MIA-BRK-001',
      area_type: 'NEIGHBORHOOD',
      zip_code: '33131',
      city: 'Miami',
      state: 'FL',
      county: 'Miami-Dade',
      median_price: 685000,
      avg_price: 795000,
      price_per_sqft: 685,
      price_change: 8.5,
      days_on_market: 52,
      inventory: 425,
      median_age: 35.5,
      median_income: 95000,
      households: 15500,
      school_rating: 6.5,
      walk_score: 92,
      bike_score: 75,
      crime_index: 'MEDIUM',
      park_proximity: 0.4,
      commute_time: 15,
      rent_yield: 4.5,
      appreciation_rate: 7.2,
      investment_grade: 'B',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-17'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'Pinecrest',
      area_code: 'PIN-001',
      area_type: 'ZIP',
      zip_code: '33156',
      city: 'Pinecrest',
      state: 'FL',
      county: 'Miami-Dade',
      median_price: 925000,
      avg_price: 1085000,
      price_per_sqft: 425,
      price_change: 6.2,
      days_on_market: 55,
      inventory: 68,
      median_age: 45.5,
      median_income: 135000,
      households: 6500,
      school_rating: 7.8,
      walk_score: 32,
      bike_score: 42,
      crime_index: 'LOW',
      park_proximity: 0.8,
      commute_time: 28,
      rent_yield: 3.2,
      appreciation_rate: 5.2,
      investment_grade: 'B',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-18'),
    },

    // AUSTIN, TX - Fair Schools (5.0-5.9)
    {
      organization_id: TEST_ORG_ID,
      area_name: 'East Austin - Mueller',
      area_code: 'ATX-MUE-004',
      area_type: 'NEIGHBORHOOD',
      zip_code: '78702',
      city: 'Austin',
      state: 'TX',
      county: 'Travis',
      median_price: 485000,
      avg_price: 535000,
      price_per_sqft: 385,
      price_change: 12.5,
      days_on_market: 22,
      inventory: 58,
      median_age: 32.5,
      median_income: 68000,
      households: 9500,
      school_rating: 5.8,
      walk_score: 78,
      bike_score: 82,
      crime_index: 'MEDIUM',
      park_proximity: 0.3,
      commute_time: 15,
      rent_yield: 5.8,
      appreciation_rate: 9.5,
      investment_grade: 'A',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-19'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'South Austin - St. Edwards',
      area_code: 'ATX-STE-005',
      area_type: 'NEIGHBORHOOD',
      zip_code: '78744',
      city: 'Austin',
      state: 'TX',
      county: 'Travis',
      median_price: 365000,
      avg_price: 395000,
      price_per_sqft: 265,
      price_change: 11.2,
      days_on_market: 25,
      inventory: 95,
      median_age: 33.5,
      median_income: 58000,
      households: 15500,
      school_rating: 5.5,
      walk_score: 52,
      bike_score: 58,
      crime_index: 'MEDIUM',
      park_proximity: 1.2,
      commute_time: 28,
      rent_yield: 6.5,
      appreciation_rate: 8.5,
      investment_grade: 'B',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-20'),
    },

    // DENVER, CO - Fair Schools (5.0-5.9)
    {
      organization_id: TEST_ORG_ID,
      area_name: 'Denver - Five Points',
      area_code: 'DEN-5PT-002',
      area_type: 'NEIGHBORHOOD',
      zip_code: '80205',
      city: 'Denver',
      state: 'CO',
      county: 'Denver',
      median_price: 485000,
      avg_price: 525000,
      price_per_sqft: 385,
      price_change: 9.8,
      days_on_market: 28,
      inventory: 75,
      median_age: 31.5,
      median_income: 65000,
      households: 12500,
      school_rating: 5.8,
      walk_score: 85,
      bike_score: 88,
      crime_index: 'MEDIUM',
      park_proximity: 0.6,
      commute_time: 18,
      rent_yield: 5.5,
      appreciation_rate: 8.2,
      investment_grade: 'B',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-21'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'Aurora - East Colfax',
      area_code: 'AUR-ECX-001',
      area_type: 'NEIGHBORHOOD',
      zip_code: '80010',
      city: 'Aurora',
      state: 'CO',
      county: 'Arapahoe',
      median_price: 365000,
      avg_price: 395000,
      price_per_sqft: 245,
      price_change: 8.5,
      days_on_market: 32,
      inventory: 125,
      median_age: 34.5,
      median_income: 52000,
      households: 18500,
      school_rating: 5.2,
      walk_score: 58,
      bike_score: 62,
      crime_index: 'MEDIUM',
      park_proximity: 1.5,
      commute_time: 35,
      rent_yield: 6.8,
      appreciation_rate: 7.5,
      investment_grade: 'C',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-22'),
    },

    // PHOENIX, AZ - Fair Schools (5.0-5.9)
    {
      organization_id: TEST_ORG_ID,
      area_name: 'Phoenix - Central City',
      area_code: 'PHX-CC-001',
      area_type: 'NEIGHBORHOOD',
      zip_code: '85006',
      city: 'Phoenix',
      state: 'AZ',
      county: 'Maricopa',
      median_price: 325000,
      avg_price: 365000,
      price_per_sqft: 225,
      price_change: 10.5,
      days_on_market: 28,
      inventory: 185,
      median_age: 32.5,
      median_income: 48000,
      households: 25500,
      school_rating: 5.5,
      walk_score: 68,
      bike_score: 72,
      crime_index: 'MEDIUM',
      park_proximity: 0.8,
      commute_time: 20,
      rent_yield: 7.2,
      appreciation_rate: 8.8,
      investment_grade: 'B',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-23'),
    },

    // MIAMI, FL - Fair Schools (5.0-5.9)
    {
      organization_id: TEST_ORG_ID,
      area_name: 'Miami - Little Havana',
      area_code: 'MIA-LH-002',
      area_type: 'NEIGHBORHOOD',
      zip_code: '33135',
      city: 'Miami',
      state: 'FL',
      county: 'Miami-Dade',
      median_price: 385000,
      avg_price: 425000,
      price_per_sqft: 365,
      price_change: 9.5,
      days_on_market: 38,
      inventory: 145,
      median_age: 38.5,
      median_income: 42000,
      households: 28500,
      school_rating: 5.8,
      walk_score: 78,
      bike_score: 68,
      crime_index: 'MEDIUM',
      park_proximity: 1.0,
      commute_time: 22,
      rent_yield: 6.5,
      appreciation_rate: 8.2,
      investment_grade: 'B',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-24'),
    },

    {
      organization_id: TEST_ORG_ID,
      area_name: 'Hialeah',
      area_code: 'HIA-001',
      area_type: 'ZIP',
      zip_code: '33012',
      city: 'Hialeah',
      state: 'FL',
      county: 'Miami-Dade',
      median_price: 345000,
      avg_price: 385000,
      price_per_sqft: 285,
      price_change: 8.8,
      days_on_market: 42,
      inventory: 225,
      median_age: 36.5,
      median_income: 38000,
      households: 85500,
      school_rating: 5.2,
      walk_score: 62,
      bike_score: 55,
      crime_index: 'MEDIUM',
      park_proximity: 1.2,
      commute_time: 28,
      rent_yield: 7.2,
      appreciation_rate: 7.5,
      investment_grade: 'C',
      data_source: 'Zillow + GreatSchools + Census',
      created_by_id: TEST_USER_ID,
      created_at: new Date('2024-09-25'),
    },
  ];

  // Create all neighborhood insights
  let successCount = 0;
  let errorCount = 0;

  for (const insight of insights) {
    try {
      await prisma.neighborhood_insights.create({
        data: insight,
      });
      successCount++;
      console.log(`  ✅ Created: ${insight.area_name} (School Rating: ${insight.school_rating}, Grade: ${insight.investment_grade})`);
    } catch (error) {
      errorCount++;
      console.error(`  ❌ Failed: ${insight.area_name}`);
      console.error(`     Error: ${error instanceof Error ? error.message : 'Unknown error'}`);
    }
  }

  console.log('');
  console.log('✅ Neighborhood insights seeding completed!');
  console.log('');
  console.log('Summary:');
  console.log(`  • Total neighborhoods: ${insights.length}`);
  console.log(`  • Successfully created: ${successCount}`);
  console.log(`  • Failed: ${errorCount}`);
  console.log('');

  console.log('School Rating Distribution:');
  const excellent = insights.filter(i => i.school_rating >= 8.0);
  const good = insights.filter(i => i.school_rating >= 6.0 && i.school_rating < 8.0);
  const fair = insights.filter(i => i.school_rating >= 5.0 && i.school_rating < 6.0);
  console.log(`  • Excellent (8.0+): ${excellent.length} neighborhoods`);
  console.log(`    - Average school rating: ${(excellent.reduce((sum, i) => sum + i.school_rating, 0) / excellent.length).toFixed(1)}`);
  console.log(`    - Average price: $${Math.round(excellent.reduce((sum, i) => sum + (i.median_price || 0), 0) / excellent.length).toLocaleString()}`);
  console.log(`  • Good (6.0-7.9): ${good.length} neighborhoods`);
  console.log(`    - Average school rating: ${(good.reduce((sum, i) => sum + i.school_rating, 0) / good.length).toFixed(1)}`);
  console.log(`    - Average price: $${Math.round(good.reduce((sum, i) => sum + (i.median_price || 0), 0) / good.length).toLocaleString()}`);
  console.log(`  • Fair (5.0-5.9): ${fair.length} neighborhoods`);
  console.log(`    - Average school rating: ${(fair.reduce((sum, i) => sum + i.school_rating, 0) / fair.length).toFixed(1)}`);
  console.log(`    - Average price: $${Math.round(fair.reduce((sum, i) => sum + (i.median_price || 0), 0) / fair.length).toLocaleString()}`);
  console.log('');

  console.log('Investment Grade Breakdown:');
  const gradeA = insights.filter(i => i.investment_grade === 'A');
  const gradeB = insights.filter(i => i.investment_grade === 'B');
  const gradeC = insights.filter(i => i.investment_grade === 'C');
  console.log(`  • Grade A: ${gradeA.length} neighborhoods`);
  console.log(`  • Grade B: ${gradeB.length} neighborhoods`);
  console.log(`  • Grade C: ${gradeC.length} neighborhoods`);
  console.log('');

  console.log('Cities Covered:');
  const cities = [...new Set(insights.map(i => i.city))];
  cities.forEach(city => {
    const cityInsights = insights.filter(i => i.city === city);
    const avgSchoolRating = (cityInsights.reduce((sum, i) => sum + i.school_rating, 0) / cityInsights.length).toFixed(1);
    console.log(`  • ${city}: ${cityInsights.length} neighborhoods (Avg school rating: ${avgSchoolRating})`);
  });
  console.log('');

  console.log('Area Type Distribution:');
  const neighborhoods = insights.filter(i => i.area_type === 'NEIGHBORHOOD');
  const zips = insights.filter(i => i.area_type === 'ZIP');
  console.log(`  • Neighborhood: ${neighborhoods.length}`);
  console.log(`  • ZIP Code Area: ${zips.length}`);
  console.log('');

  console.log('Price Correlation with School Rating:');
  console.log(`  • Overall average school rating: ${(insights.reduce((sum, i) => sum + i.school_rating, 0) / insights.length).toFixed(2)}`);
  console.log(`  • Overall average median price: $${Math.round(insights.reduce((sum, i) => sum + (i.median_price || 0), 0) / insights.length).toLocaleString()}`);
  console.log(`  • Correlation: Higher school ratings generally correlate with higher prices`);
  console.log('');
}

seedNeighborhoodInsights()
  .catch((error) => {
    console.error('❌ Seeding failed:');
    console.error(error);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
